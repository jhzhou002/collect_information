# 评论任务信息收集系统 - 微信小程序

## 功能说明

### 1. 首页
- 轮播图展示（支持自定义图片）
- 欢迎标题和说明文字
- 信息登记按钮（跳转到提交页面）
- 快捷功能入口（提交历史、个人中心）
- 使用说明

### 2. 信息登记页面（独立页面）
- 用户昵称输入
- 文章链接输入（支持URL自动提取）
- 动态添加/删除链接（1-10个）
- 提交记录
- 登录状态检查

### 3. 我的页面
- 点击头像登录（未登录状态）
- 用户信息展示（头像+昵称，已登录状态）
- 二维码管理（上传/预览）
- 提交历史入口
- 退出登录

### 4. 上传二维码页面
- 选择/拍摄二维码图片
- 上传到七牛云
- 预览已上传的二维码

### 5. 提交历史页面
- 历史记录列表
- 查看提交详情
- 结算状态显示
- 下拉刷新

## 配置说明

### 1. 修改AppID

打开 `project.config.json`，修改 `appid` 为你的小程序AppID：

```json
{
  "appid": "your-appid"
}
```

### 2. 修改API地址

打开 `app.js`，修改 `apiBase` 为你的后端API地址：

```javascript
globalData: {
  apiBase: 'https://example.com/api' // 修改为实际API地址
}
```

### 3. 配置微信小程序后台

在微信小程序后台配置以下内容：

#### 服务器域名配置
- request合法域名：添加后端API域名
- uploadFile合法域名：添加 `https://upload.qiniup.com`（七牛云上传）
- downloadFile合法域名：添加七牛云域名 `https://qiniu.aihubzone.cn`

#### 业务域名配置
- 添加后端API域名（用于网页跳转等）

## 使用说明

### 1. 导入项目

使用微信开发者工具打开 `miniprogram` 目录

### 2. 安装依赖

小程序为原生开发，无需安装npm依赖

### 3. 配置AppID和API地址

按照上述配置说明修改相关配置

### 4. 编译运行

在微信开发者工具中点击编译即可运行

### 5. 真机调试

使用微信开发者工具的真机调试功能进行测试

### 6. 上传发布

1. 在微信开发者工具中点击"上传"
2. 填写版本号和项目备注
3. 登录微信小程序后台提交审核
4. 审核通过后发布

## 目录结构

```
miniprogram/
├── pages/                # 页面
│   ├── index/           # 首页
│   ├── mine/            # 我的
│   ├── upload-qrcode/   # 上传二维码
│   └── history/         # 提交历史
├── utils/               # 工具类
│   ├── request.js       # 网络请求封装
│   ├── urlExtractor.js  # URL提取工具
│   └── qiniu.js         # 七牛云上传工具
├── api/                 # API接口
│   ├── user.js          # 用户相关
│   └── submission.js    # 提交记录相关
├── images/              # 图片资源（需自行添加）
│   ├── home.png
│   ├── home-active.png
│   ├── mine.png
│   └── mine-active.png
├── app.js               # 小程序入口
├── app.json             # 全局配置
├── app.wxss             # 全局样式
└── sitemap.json         # 索引配置
```

## 注意事项

1. **登录功能**：使用微信小程序最新的授权方式（getUserProfile）
2. **URL自动提取**：粘贴包含URL的文本后，失焦时会自动提取URL
3. **七牛云上传**：图片直接从小程序上传到七牛云，后端只返回上传凭证
4. **网络请求**：需要在小程序后台配置服务器域名白名单
5. **图片资源**：需要自行准备tabBar图标（home.png, home-active.png, mine.png, mine-active.png）

## 测试账号

后端管理员账号（用于测试）：
- 用户名：admin
- 密码：admin123

## 常见问题

### 1. 无法登录
- 检查后端API地址是否正确
- 检查微信小程序AppID和Secret是否配置正确
- 检查是否在微信小程序后台配置了服务器域名

### 2. 图片上传失败
- 检查七牛云配置是否正确
- 检查是否在微信小程序后台配置了uploadFile合法域名

### 3. 网络请求失败
- 检查服务器域名是否已配置
- 检查后端服务是否正常运行
- 检查token是否过期

## 开发建议

1. 开发时可在微信开发者工具中开启"不校验合法域名"
2. 正式发布前务必配置好所有合法域名
3. 定期测试各项功能，确保用户体验
4. 注意保护用户隐私，不泄露敏感信息
